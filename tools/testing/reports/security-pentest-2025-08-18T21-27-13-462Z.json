{
  "metadata": {
    "timestamp": "2025-08-18T21:27:13.464Z",
    "testConfiguration": {
      "target": "http://localhost:4000",
      "categories": 9,
      "totalTests": 53,
      "vulnerabilitiesFound": 10
    },
    "securityMetrics": {
      "securityScore": "0%",
      "passedTests": 36,
      "failedTests": 17,
      "criticalVulnerabilities": 1,
      "highVulnerabilities": 8,
      "mediumVulnerabilities": 1
    }
  },
  "summary": {
    "overallStatus": "HIGH RISK",
    "securityScore": 0,
    "recommendations": [
      {
        "priority": "IMMEDIATE",
        "category": "Critical Security",
        "recommendation": "Address critical vulnerabilities immediately before production deployment",
        "impact": "System compromise possible"
      },
      {
        "priority": "HIGH",
        "category": "JWT Security",
        "recommendation": "Ensure JWT library rejects \"none\" algorithm tokens",
        "impact": "Authentication bypass"
      },
      {
        "priority": "MEDIUM",
        "category": "Rate Limiting",
        "recommendation": "Implement rate limiting on authentication endpoints",
        "impact": "Brute force attack protection"
      }
    ]
  },
  "detailedResults": [
    {
      "category": "Authentication Bypass",
      "tests": [
        {
          "test": "No Authorization Header",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Protected endpoint accessible without authentication"
        },
        {
          "test": "Invalid Token: Bearer invalid...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        },
        {
          "test": "Invalid Token: Bearer 123.456.789...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        },
        {
          "test": "Invalid Token: Bearer eyJ0eXAiOiJKV...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        },
        {
          "test": "Invalid Token: Basic dGVzdDp0ZXN0...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        },
        {
          "test": "Invalid Token: Bearer null...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        },
        {
          "test": "Invalid Token: Bearer undefined...",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Invalid token accepted"
        }
      ]
    },
    {
      "category": "Token Manipulation",
      "tests": [
        {
          "test": "None Algorithm Attack",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": "CRITICAL",
          "details": "None algorithm JWT accepted - critical security flaw"
        },
        {
          "test": "Weak Secret Test: \"secret\"",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "Weak Secret Test: \"123456\"",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "Weak Secret Test: \"password\"",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "Weak Secret Test: \"jwt\"",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "Weak Secret Test: \"key\"",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "Weak Secret Test: \"empty\"",
          "error": "secretOrPrivateKey must have a value",
          "passed": true
        },
        {
          "test": "Token Tampering",
          "expected": 401,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        }
      ]
    },
    {
      "category": "Role Escalation",
      "tests": [
        {
          "test": "user role accessing /api/admin/users",
          "expected": [
            401,
            403
          ],
          "actual": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "guest role accessing /api/admin/system",
          "expected": [
            401,
            403
          ],
          "actual": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "null role accessing /api/admin/config",
          "expected": [
            401,
            403
          ],
          "actual": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "admin role accessing /api/admin/test",
          "expected": 200,
          "actual": 404,
          "passed": false,
          "vulnerability": null,
          "details": null
        }
      ]
    },
    {
      "category": "Input Validation",
      "tests": [
        {
          "test": "GET /api/search with \"admin...\"",
          "payload": "admin",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"admin...\"",
          "payload": "admin",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"admin...\"",
          "payload": "admin",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"administrator...\"",
          "payload": "administrator",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"administrator...\"",
          "payload": "administrator",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"administrator...\"",
          "payload": "administrator",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"root...\"",
          "payload": "root",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"root...\"",
          "payload": "root",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"root...\"",
          "payload": "root",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"test...\"",
          "payload": "test",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"test...\"",
          "payload": "test",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"test...\"",
          "payload": "test",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"guest...\"",
          "payload": "guest",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"guest...\"",
          "payload": "guest",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"guest...\"",
          "payload": "guest",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"anonymous...\"",
          "payload": "anonymous",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"anonymous...\"",
          "payload": "anonymous",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"anonymous...\"",
          "payload": "anonymous",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"1=1...\"",
          "payload": "1=1",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"1=1...\"",
          "payload": "1=1",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"1=1...\"",
          "payload": "1=1",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"'; DROP TABLE users;...\"",
          "payload": "'; DROP TABLE users; --",
          "statusCode": 404,
          "passed": false,
          "vulnerability": "HIGH",
          "details": "Possible SQL injection detected"
        },
        {
          "test": "POST /api/users/profile with \"'; DROP TABLE users;...\"",
          "payload": "'; DROP TABLE users; --",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"'; DROP TABLE users;...\"",
          "payload": "'; DROP TABLE users; --",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"<script>alert(\"XSS\")...\"",
          "payload": "<script>alert(\"XSS\")</script>",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"<script>alert(\"XSS\")...\"",
          "payload": "<script>alert(\"XSS\")</script>",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"<script>alert(\"XSS\")...\"",
          "payload": "<script>alert(\"XSS\")</script>",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"../../etc/passwd...\"",
          "payload": "../../etc/passwd",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"../../etc/passwd...\"",
          "payload": "../../etc/passwd",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"../../etc/passwd...\"",
          "payload": "../../etc/passwd",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "GET /api/search with \"../../../windows/sys...\"",
          "payload": "../../../windows/system32/config/sam",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/users/profile with \"../../../windows/sys...\"",
          "payload": "../../../windows/system32/config/sam",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        },
        {
          "test": "POST /api/login with \"../../../windows/sys...\"",
          "payload": "../../../windows/system32/config/sam",
          "statusCode": 404,
          "passed": true,
          "vulnerability": null,
          "details": null
        }
      ]
    },
    {
      "category": "Rate Limiting",
      "tests": [
        {
          "test": "Login Rate Limiting",
          "totalAttempts": 20,
          "rateLimitedRequests": 0,
          "successfulRequests": 20,
          "passed": false,
          "vulnerability": "MEDIUM",
          "details": "No rate limiting detected on login endpoint"
        }
      ]
    }
  ],
  "vulnerabilities": [
    {
      "test": "No Authorization Header",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Protected endpoint accessible without authentication"
    },
    {
      "test": "Invalid Token: Bearer invalid...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "Invalid Token: Bearer 123.456.789...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "Invalid Token: Bearer eyJ0eXAiOiJKV...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "Invalid Token: Basic dGVzdDp0ZXN0...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "Invalid Token: Bearer null...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "Invalid Token: Bearer undefined...",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Invalid token accepted"
    },
    {
      "test": "None Algorithm Attack",
      "expected": 401,
      "actual": 404,
      "passed": false,
      "vulnerability": "CRITICAL",
      "details": "None algorithm JWT accepted - critical security flaw"
    },
    {
      "test": "GET /api/search with \"'; DROP TABLE users;...\"",
      "payload": "'; DROP TABLE users; --",
      "statusCode": 404,
      "passed": false,
      "vulnerability": "HIGH",
      "details": "Possible SQL injection detected"
    },
    {
      "test": "Login Rate Limiting",
      "totalAttempts": 20,
      "rateLimitedRequests": 0,
      "successfulRequests": 20,
      "passed": false,
      "vulnerability": "MEDIUM",
      "details": "No rate limiting detected on login endpoint"
    }
  ]
}