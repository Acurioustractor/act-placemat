# Fail2ban filter for Australian compliance scanning attempts
# Detects unauthorized compliance/privacy scanning

[Definition]
# Detect compliance scanning and unauthorized access attempts
failregex = ^<HOST> .* "GET /\.well-known/.*" .*$
            ^<HOST> .* "GET /robots\.txt" .*$
            ^<HOST> .* "GET /sitemap\.xml" .*$
            ^<HOST> .* ".*compliance.*" .*$
            ^<HOST> .* ".*privacy.*" .*$
            ^<HOST> .* ".*audit.*" .*$
            ^<HOST> .* ".*gdpr.*" .*$
            ^<HOST> .* ".*security\.txt" .*$
            ^<HOST> .* ".*config.*" .*$
            ^<HOST> .* ".*admin.*" .*$
            ^<HOST> .* ".*backup.*" .*$
            ^<HOST> .* ".*\.env.*" .*$
            ^<HOST> .* ".*\.git.*" .*$

# Ignore legitimate Australian government scanners (if any)
ignoreregex = ^<HOST> .* ".*" .* .* ".*\.gov\.au.*" .*$

[INCLUDES]
before = common.conf

[Definition]
datepattern = %%d/%%b/%%Y:%%H:%%M:%%S %%z