# Fail2ban action for Australian compliance logging
# Logs security events with Australian compliance metadata

[Definition]
# Action when an IP is banned
actionstart = echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S %%Z') - Fail2ban started for <name> - Australian compliance active" >> /var/log/fail2ban/australian-compliance.log
              
actionstop = echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S %%Z') - Fail2ban stopped for <name>" >> /var/log/fail2ban/australian-compliance.log

actioncheck = 

actionban = echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S %%Z') - SECURITY INCIDENT: IP <ip> banned for <name> violation" >> /var/log/fail2ban/australian-compliance.log
            echo "Data-Residency: Australia" >> /var/log/fail2ban/australian-compliance.log
            echo "Compliance-Framework: Australian-Privacy-Act" >> /var/log/fail2ban/australian-compliance.log
            echo "Incident-Type: <name>" >> /var/log/fail2ban/australian-compliance.log
            echo "Source-IP: <ip>" >> /var/log/fail2ban/australian-compliance.log
            echo "Ban-Duration: <bantime>" >> /var/log/fail2ban/australian-compliance.log
            echo "Privacy-Impact: Potential" >> /var/log/fail2ban/australian-compliance.log
            echo "Investigation-Required: Yes" >> /var/log/fail2ban/australian-compliance.log
            echo "Retention-Period: 7-years" >> /var/log/fail2ban/australian-compliance.log
            echo "---" >> /var/log/fail2ban/australian-compliance.log

actionunban = echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S %%Z') - IP <ip> unbanned for <name>" >> /var/log/fail2ban/australian-compliance.log
              echo "Incident-Resolved: <name> for <ip>" >> /var/log/fail2ban/australian-compliance.log
              echo "---" >> /var/log/fail2ban/australian-compliance.log

[Init]
name = default
bantime = 600
logpath = /var/log/fail2ban/fail2ban.log